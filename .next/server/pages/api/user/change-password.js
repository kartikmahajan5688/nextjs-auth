"use strict";(()=>{var e={};e.id=913,e.ids=[913],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},9879:(e,t,a)=>{a.r(t),a.d(t,{config:()=>w,default:()=>p,routeModule:()=>f});var s={};a.r(s),a.d(s,{default:()=>c});var r=a(1802),n=a(7153),o=a(6249);let i=require("next-auth/client");var u=a(5753),d=a(6573);async function l(e,t){if("PATCH"!==e.method)return;let a=await (0,i.getSession)({req:e});if(!a){t.status(401).json({message:"Not authenticated!"});return}let s=a.user.email,r=e.body.oldPassword,n=e.body.newPassword,o=await (0,d.v)(),l=o.db().collection("users"),c=await l.findOne({email:s});if(!c){t.status(404).json({message:"User not found."}),o.close();return}let m=c.password,p=await (0,u.G)(r,m);if(!p){t.status(403).json({message:"Invalid password."}),o.close();return}let w=await (0,u.c)(n);await l.updateOne({email:s},{$set:{password:w}}),o.close(),t.status(200).json({message:"Password updated!"})}let c=l,m=r.PagesAPIRouteModule,p=(0,o.l)(s,"default"),w=(0,o.l)(s,"config"),f=new m({definition:{kind:n.x.PAGES_API,page:"/api/user/change-password",pathname:"/api/user/change-password",bundlePath:"",filename:""},userland:s})},5753:(e,t,a)=>{a.d(t,{c:()=>r,G:()=>n});let s=require("bcryptjs");async function r(e){let t=await (0,s.hash)(e,12);return t}async function n(e,t){let a=await (0,s.compare)(e,t);return a}},6573:(e,t,a)=>{a.d(t,{v:()=>r});let s=require("mongodb");async function r(){let e=await s.MongoClient.connect("mongodb+srv://kartikmahajan5688:MkRNfX4SWy2N7ayy@cluster0.6oakhcl.mongodb.net/nextjsAuth?retryWrites=true&w=majority");return e}}};var t=require("../../../webpack-api-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[222],()=>a(9879));module.exports=s})();